jQuery(document).ready(function(a){function r(b,c){if(q==c)s(p,b);else{a(".ced_iimp_loader_wrap,.ced_iimp_spinner").removeClass("ced_iimp_hide");var d="https://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+setting_obj.fappid+"&tags="+b+"&per_page="+e+"&format=json&page="+c+"&license="+license+"&sort="+f+"&extras=license,owner_name,url_sq%2C+url_t%2C+url_s%2C+url_m%2C+url_l%2C+url_o%2C+url_q",h=new XMLHttpRequest;h.open("GET",d),h.onreadystatechange=function(){if(a(".ced_iimp_loader_wrap,.ced_iimp_spinner").addClass("ced_iimp_hide"),4==h.readyState&&200==h.status){response=h.responseText;var d=response.lastIndexOf(")");if(response=response.slice(14,d),response=JSON.parse(response),!(response.photos.total>0))return a("#ced_iimp_wpiimp_resultF").html(setting_obj.no_hit),!1;p={flickr:{total:response.photos.total,page:response.photos.page,totalPages:response.photos.pages,perPage:response.photos.perpage,images:response.photos.photo}},q=c,g.push(b),s(p,b)}},h.send()}return!1}function t(b,e){if(e in l)u(p,b);else{var f,g="https://pixabay.com/api/?key="+setting_obj.pappid+"&response_group=high_resolution&image_type="+j+"&orientation="+k+"&q="+b+"&lang="+c+"&per_page="+d+"&page="+e;f=new XMLHttpRequest,f.open("GET",g),f.onreadystatechange=function(){if(4==f.readyState&&200==f.status){if(response=JSON.parse(f.responseText),!(response.totalHits>0))return a("#ced_iimp_wpiimp_result").html("No hit found"),!1;l[e]=response,p={pixabay:{total:response.total,page:e,totalHits:response.totalHits,totalPages:Math.ceil(response.totalHits/d),perPage:response.page_size,images:response.hits}},u(p,b)}},f.send()}return!1}var i,j,k,b=setting_obj.postid,c=setting_obj.lang,d=setting_obj.page_size,e=setting_obj.page_size_f,f=setting_obj.sort,g=[];license=setting_obj.license;var l,m=[],p={},q=0;a(".ced_iimp_tab").on("click",function(){var b=a(this),c=b.data("name");a(document).find(".ced_iimp_tab-content").addClass("ced_iimp_hide"),a(document).find(".ced_iimp_tab-content-"+c).removeClass("ced_iimp_hide"),a(document).find(".ced_iimp_tab_active.ced_iimp_tab").removeClass("ced_iimp_tab_active"),a(document).find(".ced_iimp_tab-"+c).addClass("ced_iimp_tab_active")}),a("#ced_iimp_img_search_form").submit(function(b){b.preventDefault(),i=a("#ced_iimp_query").val(),j=a("#ced_iimp_fetch_photo").is(":checked")&&!a("#fetch_cliparts").is(":checked")?"image":!a("#ced_iimp_fetch_photo").is(":checked")&&a("#fetch_cliparts").is(":checked")?"clipart":"all",a("#ced_iimp_fetch_horizental").is(":checked")&&!a("#fetch_vertical").is(":checked")?k="horizontal":!a("#ced_iimp_fetch_horizental").is(":checked")&&a("#fetch_vertical").is(":checked")&&(k="vertical"),l={},m={},q=0,t(i,1),r(i,1)});var s=function(b,c){var d="",e=parseInt(b.flickr.page);d+='<div class="ced_iimp_image-list-wrapper">',d+='<div class="ced_iimp_image-list-header">',d+=""!=c&&"undefined"!=typeof c?"<h4>"+setting_obj.flickr_search+c+".</h4>":"<h4>"+setting_obj.flickr_default+"</h4>",d+="<span>"+setting_obj.total_record+b.flickr.total+".</span>",d+="</div>";for(var f in b.flickr.images)d+='<div class="ced_iimp_image-list-content-wrap">',d+='<div class="thumb ced_iimp_image-list-content">',d+='<a class="ced_iimp_image_anchor" rel="gallery-plants" data-idx="'+f+'" data-src="'+b.flickr.images[f].url_m+'">',d+='<img class="attachment ced_iimp_image" src="'+b.flickr.images[f].url_s+'">',d+="</a>","undefined"!=typeof b.flickr.images[f].width_s&&(d+='<input type="hidden" class="ced_iimp_small_img" data-dims="'+b.flickr.images[f].width_s+"x"+b.flickr.images[f].height_s+'" data-src="'+b.flickr.images[f].url_s+'" data-user="'+b.flickr.images[f].ownername+'">'),"undefined"!=typeof b.flickr.images[f].width_m&&(d+='<input type="hidden" class="ced_iimp_medium_img" data-dims="'+b.flickr.images[f].width_m+"x"+b.flickr.images[f].height_m+'" data-src="'+b.flickr.images[f].url_m+'" data-user="'+b.flickr.images[f].ownername+'">'),"undefined"==typeof b.flickr.images[f].width_l&&(d+='<input type="hidden" class="ced_iimp_large_img" data-dims="'+b.flickr.images[f].width_l+"x"+b.flickr.images[f].height_l+'" data-src="'+b.flickr.images[f].url_l+'" data-user="'+b.flickr.images[f].ownername+'">'),d+='<input type="hidden" class="ced_iimp_img_from" data-value="flickr">',d+="</div>",d+="</div>";d+="</div>",d+='<div style="clear: both;"></div>',d+='<div id="ced_iimp_paginator">',d+=1==e?'<span class="button disabled">'+setting_obj.prev+"</span>":'<a data-pag_num="'+(e-1)+'" data-query="'+c+'" class="button ced_iimp_paginator_link">'+setting_obj.prev+"</a>",d+=e==b.flickr.images?'<span class="button disabled">'+setting_obj.next+"</span>":'<a data-page_num="'+(e+1)+'" data-query="'+c+'" class="button ced_iimp_paginator_link">'+setting_obj.next+"</a>",d+="</div>",d+='<div style="clear: both;"></div>',a("#ced_iimp_wpiimp_resultF").html(d),a("html,body").animate({scrollTop:a(".ced_iimp_img_search_wrapper").offset().top+a(".ced_iimp_img_search_wrapper").height()+50},"slow")},u=function(b,c){var d="",e=parseInt(b.pixabay.page);d+='<div class="ced_iimp_image-list-wrapper">',d+='<div class="ced_iimp_image-list-header">',d+=""!=c&&"undefined"!=typeof c?"<h4>"+setting_obj.pixabay_search+c+".</h4>":"<h4>"+setting_obj.pixabay_default+"</h4>",d+="<span>"+setting_obj.total_record+b.pixabay.total+".</span>",d+="</div>";for(var f in b.pixabay.images)d+='<div class="ced_iimp_image-list-content-wrap">',d+='<div class="thumb ced_iimp_image-list-content">',d+='<a class="ced_iimp_image_anchor" rel="gallery-plants" data-idx="'+f+'" data-src="'+b.pixabay.images[f].webformatURL+'">',d+='<img src="'+b.pixabay.images[f].previewURL+'">',d+="</a>","undefined"!=typeof b.pixabay.images[f].previewWidth&&(d+='<input type="hidden" class="ced_iimp_small_img" data-dims="'+b.pixabay.images[f].previewWidth+"x"+b.pixabay.images[f].previewHeight+'" data-src="'+b.pixabay.images[f].previewURL+'" data-user="'+b.pixabay.images[f].user+'">'),"undefined"!=typeof b.pixabay.images[f].webformatWidth&&(d+='<input type="hidden" class="ced_iimp_medium_img" data-dims="'+b.pixabay.images[f].webformatWidth+"x"+b.pixabay.images[f].webformatHeight+'" data-src="'+b.pixabay.images[f].webformatURL+'" data-user="'+b.pixabay.images[f].user+'">'),"undefined"!=typeof b.pixabay.images[f].imageWidth&&(d+='<input type="hidden" class="ced_iimp_large_img" data-dims="'+b.pixabay.images[f].imageWidth+"x"+b.pixabay.images[f].imageHeight+'" data-src="'+b.pixabay.images[f].imageURL+'" data-user="'+b.pixabay.images[f].user+'">'),d+='<input type="hidden" class="ced_iimp_img_from" data-value="pixabay">',d+="</div>",d+="</div>";d+="</div>",d+='<div style="clear: both;"></div>',d+='<div id="ced_iimp_paginator_pixa">',d+=1==e?'<span class="button disabled">'+setting_obj.prev+"</span>":'<a data-pag_num="'+(e-1)+'" data-query="'+c+'" class="button ced_iimp_paginator_pixa_link">'+setting_obj.prev+"</a>",d+=e==b.pixabay.images?'<span class="button disabled">'+setting_obj.next+"</span>":'<a data-page_num="'+(e+1)+'" data-query="'+c+'" class="button ced_iimp_paginator_pixa_link">'+setting_obj.next+"</a>",d+="</div>",d+='<div style="clear: both;"></div>',a("#ced_iimp_wpiimp_result").html(d),a("html,body").animate({scrollTop:a(".ced_iimp_img_search_wrapper").offset().top+a(".ced_iimp_img_search_wrapper").height()+50},"slow")};a(document).on("click",".ced_iimp_paginator_link",function(){var b=a(this).attr("data-query"),c=parseInt(a(this).attr("data-page_num"));r(b,c)}),a(document).on("click",".ced_iimp_paginator_pixa_link",function(){var b=a(this).attr("data-query"),c=parseInt(a(this).attr("data-page_num"));t(b,c)}),a(document).on("click",".ced_iimp_image_anchor",function(){if(window.tb_remove)try{window.tb_remove()}catch(b){}var c=a(this),d=c.parent().find(".ced_iimp_small_img").data("dims"),e=c.parent().find(".ced_iimp_medium_img").data("dims"),f=c.parent().find(".ced_iimp_large_img").data("dims"),g=c.parent().find(".ced_iimp_small_img").data("src"),h=c.parent().find(".ced_iimp_medium_img").data("src"),i=c.parent().find(".ced_iimp_large_img").data("src"),j=c.parent().find(".ced_iimp_small_img").data("user"),k=c.parent().find(".ced_iimp_medium_img").data("user"),l=c.parent().find(".ced_iimp_large_img").data("user"),m=c.parent().find(".ced_iimp_img_from").data("value"),n="",o=a(this).attr("data-src");return a(document).find(".ced_iimp_image-tag").attr("src",o),a(document).find(".ced_iimp_image-tag").load(),d&&g&&(a(document).find(".ced_iimp_insert_s .ced_iimp_dims").html(d),a(document).find(".ced_iimp_insert_s").attr("data-user",j),a(document).find(".ced_iimp_insert_s").attr("data-src",g).removeClass("ced_iimp_hide"),a(document).find(".ced_iimp_insert_s").attr("data-img_from",m)),e&&h&&(a(document).find(".ced_iimp_insert_m .ced_iimp_dims").html(e),a(document).find(".ced_iimp_insert_m").attr("data-user",k),a(document).find(".ced_iimp_insert_m").attr("data-src",h).removeClass("ced_iimp_hide"),a(document).find(".ced_iimp_insert_m").attr("data-img_from",m),n="Currently showing "+e),f&&i&&(a(document).find(".ced_iimp_insert_l .ced_iimp_dims").html(f),a(document).find(".ced_iimp_insert_l").attr("data-user",l),a(document).find(".ced_iimp_insert_l").attr("data-src",i).removeClass("ced_iimp_hide"),a(document).find(".ced_iimp_insert_l").attr("data-img_from",m)),tb_show(n,setting_obj.thckbox_query_arg),a(document).find("#TB_window").css("margin-top","-240px"),a(document).find(".ced_iimp_image-content-inner").parent("#TB_ajaxContent").css({height:"auto"}),!1}),a(document).on("click",".ced_iimp_insert_s, .ced_iimp_insert_m, .ced_iimp_insert_l",function(c){c.preventDefault();var d=a(this);return user=d.attr("data-user"),img_url=d.attr("data-src"),img_from=d.attr("data-img_from"),""==img_url||"undefined"==typeof img_url?(alert(setting_obj.img_unknown_error),!1):((""==b||"undefined"==typeof b)&&(b=a(document).find("#post_ID").val()),a(".ced_iimp_loader_wrap,.ced_iimp_spinner").removeClass("ced_iimp_hide"),void a.ajax({url:setting_obj.ajax_url,data:{action:"ced_iimp_save_image_to_post",insert_img:!0,img_url:img_url,img_user:user,query:i,img_from:img_from,wpnonce:setting_obj.wpiim_img_nonce},type:"post",success:function(c){a(".ced_iimp_loader_wrap,.ced_iimp_spinner").addClass("ced_iimp_hide"),parseInt(c)==c?window.location="media-upload.php?type=image&tab=library&post_id="+b+"&attachment_id="+c:console.log(c)}}))})});